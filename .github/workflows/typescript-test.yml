name: 'ðŸ“¦ Test codebase'

on: 
  workflow_call:
    input:
      NODE_VERSION:
        required: true
        type: string
      HAS_UNIT_TEST:
        required: true
        type: boolean

jobs:
  test:
    runs-on: ubuntu-latest
    needs: install
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Install dependencies
        uses: actions/setup-node@v3
        with:
            node-version: ${{ inputs.NODE_VERSION }}
            registry-url: https://registry.npmjs.org/
            cache: npm
            cache-dependency-path: package-lock.json
      - run: npm ci
      - name: Run unit tests
        if: inputs.HAS_UNIT_TEST
        run: npm test